---
layout:     post
title:      CRF关系抽取论文精读
date:       2018-08-14
auther:     Leslee
head-img:   img/darkness.png
catalog:    true
tags:
    - 论文精读

---



# 论文精读
## 摘要
关系抽取问题中定义了一般的关系类型，但是关系提取涉及到从特定的文本中提取出**关系描述符**，本文提出以序列标注的方法处理此类问题。作者修改了线性CRF的两个基线标准来更好的使用CRF解决关系抽取问题。修改如下：
* 减少可能的标签序列空间
* 引入远距离的特征（思考ing..凭这一点LSTM会不会更好）  


最终针对两个修改使用数据集进行测试，效果优于线性CRF。  

## Introduce
首先考虑三种情况：
1.  当有标注数据可用且实体类型定义的比较完善的时候，首推使用监督学习方法；  
2.  当训练数据不足的时候，推荐使用bootstrapping方法；  
3.  当没有预先定义关系类型但是存在关注的焦点语料库时，不受约束的关系发现尝试聚类实体对以识别有趣的关系类型。
4.  
本文关注一类情况：**关系类型定义为一般级别，需要更具体的关系描述。** 例如就业关系是ACE中定义的主要关系类型，在ACE评估中，这种关系的提取仅涉及决定组织实体雇用的人员实体。
然而，在实践中，如果文本中提到了这些信息，我们通常也希望找到这个人在组织中拥有的确切职位或职位。  
  
该作者提取出描述两个相关实体（例如，两个参数）之间的特定关系作为关系描述符的文本片段作为关系描述。   
传统CRF存在这样的问题：可能的标签序列的空间远小于线性链CRF所枚举的空间。具体两种含义如下：
1. liner-CRF的归一化常数太大，枚举了很多不可能的序列。
2. 允许使用远距离的特征，通过对标签序列的正确空间进行限制，防止计算成本指数级增长。

该作者对比了其方法相对于线性CRF的方法，我们的实验结果表明，减少标签序列空间和引入长程特征都可以显着提高基线性能  
## 相关工作方法
现有工作大部分从两个实体之间学习二元关系，监督学习定义是严格遵循预定义的关系类型的，而根据我们的观察，ACE中定义的一些关系类型，如“就业”关系和“人的社交”关系，是非常笼统的，可以通过更具体的描述进一步表征。   
而由于没有固定的关系类型，开放关系提取旨在提取实体对之间的所有可能的关系。   
我们为我们的任务提出的主要修改是减少标签序列空间和结合远程特征。我们注意到这些修改与Sarawagi和Cohen（2005）提出的半马尔可夫CRF模型密切相关。事实上，我们任务的修改后的CRF模型可以被认为是半马尔可夫CRF的特殊情况，我们只考虑包含至多一个关系描述符序列的标签序列。   
## 任务定义
鉴于在同一句中出现两个名称，一个作为ARG-1而另一个作为ARG-2，我们的目的是从句子中提取一段文本，该句子最好地描述两个实体之间的预定义的一般关系。
```
假设（w1,w2,....,wn）定义为一个句子序列，此时wp是ARG_1，wq是ARG2.（1=<p,q<=n,且p≠q），  
我们的目标是寻找一段子序列（wr,...,ws）.作为两个实体的关系描述（1≤r≤s≤n）.  
如果两个实体之间不存在预定义的实体关系，则返回Nil。
```
# 方法描述
## 表示形式描述
关系描述符提取任务可以作为序列标记问题进行处理。  
令X = （x1,x2,....,xn）表示关系实例序列中的观察序列，xi可以增加附加信息，例如wi的POS标签和短语的边界信息等。每一个观察序列中的xi与yi∈Y的标记相关联。从而指示出wi是否是关系描述符的一部分。
在标注过程中使用传统的BIO标注方法指示边界信息，首先定义Y=(B-REL,I-REL,O),令y=（y1,y2,....,yn）表示x的序列标签。我们的任务可以简化为找到对 x所有可能的标签序列的最佳标签序列。
## 线性CRF的解决方案
针对NLP中的序列标注任务，线性CRF Model那是相当的成功。(原文如是说..感觉现在被LSTM按在地上摩擦..)。  
这个东西就是一个无向图形模型，其中给定观察序列x的标签序列y的条件概率是
![image](https://note.youdao.com/yws/public/resource/831d6e08c83aac655a96eca3441a6b1d/xmlnote/D2DE3B634A354FECAC1926162439A630/4807)。
其中Λ={λk}是模型参数集合，fk是定义在两个连续标签和整个观测序列上的任意特征函数。并且：  
![image](https://note.youdao.com/yws/public/resource/831d6e08c83aac655a96eca3441a6b1d/xmlnote/9310145EB0D84D55B2F87ACCAE3398EA/4823)  
这个东西是归一化函数。  

```
《形象描述》https://blog.csdn.net/lskyne/article/details/8669301
```
给定一个训练实例{xj，ýj}，ýj是xj的正确标签序列。通过训练实例可以得到：  
![image](https://note.youdao.com/yws/public/resource/831d6e08c83aac655a96eca3441a6b1d/xmlnote/7CCE3E11531144789329731E31B5AFE7/4837)  
参数是正则项；  

## 线性CRF的改进  
我们注意到虽然我们可以直接应用线性链CRF来提取关系描述符，但我们的任务有一些特殊属性允许修改标准线性链CRF以满足我们的需求。<原文描述>  
### 标签序列约束
在线性CRF中，归一化常数Z 考虑所有可能的标签序列y。然而，对于关系描述提取问题，我们希望能存在单个的关系描述符或者没有这样的关系描述符。则，针对这个问题，我们只需要两种标签序列：
1. 所有的yi都是O；
2. 这个序列中恰好有一个B-REL，且有一个或者多个是连续的I-REL，其他的yi都是O；  

因此，标签序列的空间应该减少到仅满足上述约束的那些空间。  
那么怎么减少到仅满足上述约束呢？该作者提出在测试阶段强制执行这个约束。这样就可以选择在“有效标签序列空间”中选择最高概率的标签来代替整个标签序列空间的序列。  
考量针对一个候选关系实例x，我们令Ý表示一个“有效的标签序列”，例如：具有一个关系实例或者没有关系描述的关系描述句子。我们可以选择最好的ý序列标签如下：  
![image](https://note.youdao.com/yws/public/resource/831d6e08c83aac655a96eca3441a6b1d/xmlnote/B5A40763C56C441BAC0332B28591DCBC/4886)  
严格来说，利用约束最好的办法是修改概率模型本身。所以，在训练阶段，我们应该通过修改归一化参数的方式来仅考虑“有效的标签序列”。  
![image](https://note.youdao.com/yws/public/resource/831d6e08c83aac655a96eca3441a6b1d/xmlnote/A6E4A703C4BE445FB118BE82CA51533B/4894)  
可以对比一下上式与式（3）的异同点，就可以发现作者的作出改变之处：线性CRF不考虑实例的内在情况，统一将所有可能性进行归一化操作，而作者通过调整归一化范围，做到只统计 其提出改进的亮点的情况。  
等式（5）和等式（2）之间的差异是所考虑的标签序列集。换句话说，在线性链CRF中，正确的标记序列与所有可能的标签序列竞争概率质量，对于我们的任务，正确的标记序列应该与另一个有效的标记序列竞争。<作者原话>  
### 增加长范围特征
线性CRF只考虑一阶标签依赖性，因为其特征是定义在两个连续的标签上的。  
也存在更具有一般性的CRF Model，这种Model允许超过两个连续标记的远程特征。但是这种Model的计算复杂度会更高，因为计算可能性指数级增长。  
作者的任务而言，由于其对标签序列的空间进行了限制，因此使用远程特征虽然计算量大增，但是需要计算的样本数减少了，一定程度上有所弥补。因为增加了约束，已经计数的序列数量大量减少<作者原话，感觉这样做是非常巧妙，典型的一个思路解决两种问题，俗话“一箭双雕”。>  
假设g(y,x)定义为一个特征函数，表示整个标记序列和观察序列的特征函数。所以作者的Model中的特征函数如下：  
![image](https://note.youdao.com/yws/public/resource/831d6e08c83aac655a96eca3441a6b1d/xmlnote/EFF4DAEFD4234ACBA05E133B8D27435F/4934)  
其中，Θ = {λk，μl}，是整个模型的参数集合。这两个参数都通过公式3中进行正则化；  
这里上述公式中f(yi-1,yi,x)虽然可以归入到g(y,x)中，但是本文仍然将其提取出来，将线性CRF可以捕捉到的所有特征用f这个函数来表示，然后用g来专门表示长范围的特征。在第五章增加附加函数g，关系抽取性能进一步提高。  
### 特征
在对线性CRF作出修改后，针对修改后的Model提取特征。  
1. 线性链特征  
  线性链特征是可以归入到f(yi-1,yi,x)中捕获的特征，例如那些只依赖于两个连续标签的标签。该作者选用特征有：**tokens(句子)、POS Tags(词性)、phrase boundry information(短语边界信息)和标签值特征**，令ti表示wi的词性标签，pi表示边界信息，用BIO标记法进行标记。表2显示了仅涵盖观察结果的特征模板。表2表示了当前标签的值与前一个标签的值之间的组合。yi形成0阶和1阶特征。  
2. 长范围特征  
  远程特征是指仅仅根据前后短距离的标签不能定义的特征，当定义远程特征的时候，我们将**关系描述符**作为一个单元来看待。标记成REL。给定包含关系描述符序列的标签序列y，令（wr,.....ws）表示关系描述。标记方式：yr=B-REL，yt标记为I-REL。表3中总结了远程特征的模板。 这些特征捕获整个关系描述符的上下文，它与两个参数的关系，以及关系描述符的边界是否符合短语边界（因为我们希望大多数关系描述符由单个或一系列短语组成））。<作者原话>  
## 实验部分
作者标注了两个数据集，一个是用于一般“就业的”关系。另一个是人社交的关系，交person/social。  
**表2 正常的特征，考虑窗口为5，且考虑各种组合情况。**
![image](https://note.youdao.com/yws/public/resource/831d6e08c83aac655a96eca3441a6b1d/xmlnote/2410630E56734AC28A59855F11C06168/5008) 
反映在CRF中的template就是(其中一种组合特征，不一一列出)：
```
U10:%x[-2,1]
U11:%x[-1,1]
U12:%x[0,1]
U13:%x[1,1]
U14:%x[2,1]
U15:%x[-2,1]/%x[-1,1]
U16:%x[-1,1]/%x[0,1]
U17:%x[0,1]/%x[1,1]
U18:%x[1,1]/%x[2,1]
```
**表3 长距离特征模板。r表示关系描述的第一个字，s表示关系描述的最后一个字**
![image](https://note.youdao.com/yws/public/resource/831d6e08c83aac655a96eca3441a6b1d/xmlnote/299FA47F8AF1459A9E3365C41BB7F74C/5010)  
+ 语境特征：前置特征（，REL），后置特征（REL，PREP）
+ 路径特征：ARG1和关系描述符之间的单词或POS标签序列、ARG2和关系描述符之间的单词或POS标签序列、ARG1和ARG2之间的特征。
+ 边界特征：关系描述符是否违反短语边界。
### 数据预处理 
在句子分割和标记化方面，我们使用Stanford NER tag-ger（Finkel et al。，2005）来识别每个句子中的PER和ORGnamed实体。对于包含多个令牌的命名实体，我们将它们连接成一个令牌。然后，我们将每个出现在相同句子中的（PER，ORG）实体作为单个候选关系实例，其中PER实体被视为ARG-1，ORG实体被视为ARG-2。
第二个数据集来自先前使用的Wikipedia个人/社会关系数据集（Culotta等，2006）。原始数据集不包含关系描述符的注释，例如两个参数之间的“姐妹”或“朋友”。因此，我们还手动标记了该数据集。类似地，我们进行了句子分割，标记化和NER标记，并将每对（PER，PER）实体在同一个句子中作为候选反应实例进行了对比。由于“个人/社交”关系中涉及的两个参数都是PER实体，因此我们始终将第一个PER实体视为ARG-1，将第二个PER实体视为ARG-2。
<暂且不表>   
通过候选关系实例查找是否存在描述ARG-1和ARG-2之间存在关系的句子序列，如果有就将其标注出来。找不到有关系就标为Nil。**heis the son of ARG1 and ARG2**就被标记为负例，虽然可以找到其存在某些关系。再如：”ARG1 is the CEO and president of ARG2“，将the CEO and president标记出来。其包含了两个工作岗位。  
需要注意的是，这些关系并不仅仅是名词和名词短语，像人际关系的例子中“married”是动词而非名词表示配偶关系。  
### 实验设置  
实验分为线性CRF和修改后的CRF（减少标签序列但是固定使用相同的特征）和修改CRF加入语境特征和修改CRF加入长程特征，和修改CRF加入短语边界。   
  
> 具体的实验过程参考原文，不再赘述。  

## 总结
该作者针对已知了关系类型的基础上，想进一步提取关系描述符，然后根据新任务所需要的特性再进行修改。作者做了两方面改进：
> 第一，作者认为CRF考虑全局的标签可能太过多余，加入了两个限制条件，即只对那些包含了：关系描述符或者没有关系描述 的标签序列进行归一化操作，这样的操作好处就是去除了很多统计上的冗余。另一个好处体现在第二上。
> 第二，作者认为进行关系抽取的时候需要引入长距离的特征，但是计算这些长距离的特征又会造成计算量的指数型增加，这时候通过第一步的减少归一化操作的样本数来抵消掉部分计算压力。  
<全文结束>  
# 最后
> 收获：
> 1. 以前总是将监督学习的关系抽取归并于关系分类，此论文开阔的眼界，为关系抽取提供了新的思路。此文章在已知实体以及关系类型的基础上提取出具体的关系描述，可以首先将监督学习样本分类，分到固定的关系类别再采用这类方法提取出具体的关系描述符。
> 2. 针对该方法的思考：该文说明了根据远程特征对CRF作出修改得以运行该程序，那么现在如果使用可以考虑远程特征的算法会不会取得更好的效果，考虑LSTM对语料重新建模。
> 质疑：作者提出使用CRF一方面减少归一化样本数，另一方面增加特征长度，众所周知，n-gram的东西对前后的字数的计算是指数级增加的，那么减少归一化样本的计算量是否指数级的减少呢。。感觉并不是，应该耗时应该不会减少太多。  

> Conclusion:针对远程特征，如何设计通用于CRF的特征模板呢？待进一步思考。  



# **以上表述来自于Extracting Relation Descriptors with Conditional Random Fields一文，个人理解难免谬误，错误之处敬请指出！**